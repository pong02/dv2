{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "description": "A simple pie chart with embedded data.",
    "data": {
      "url": "https://raw.githubusercontent.com/pong02/dv2/master/data/waffleData.csv"
    },
    "transform": [
        {"filter":"datum.name == focus"},
        {
            "calculate": "if(isString(datum.valuation),null,round(datum.valuation * 100))",
            "as": "percent"
        },
        {"aggregate": [{
            "op": "sum",
            "field": "percent",
            "as": "new_val"
           }
        ]}
    ],
    "layer" :[
        {"mark": {"type":"arc","tooltip":true}},
        {"mark": {"type": "text",
          "fontSize":15,
          "fontWeight":"bold",
          "font":"sans-serif"
        },
        "encoding": {
          "text": {"field": "percent", "type": "quantitative"},
          "color": {"value": "#27251F"}
        }}
    ],
    
    "encoding": {
      "theta": {"field": "USDPRICE", "type": "quantitative", "title":"BigMac price"},
      "color": {"field": "category", "type": "nominal", "title":"Pricing"}
    },
    "params": [{
        "value":"China",
        "name": "focus",
        "bind": {
            "input": "select",
            "options": ["China","Hong Kong","Indonesia","India","Japan","South Korea","Malaysia","Pakistan","Philippines","Singapore","Thailand","Taiwan"],
            "labels": ["China","Hong Kong","Indonesia","India","Japan","South Korea","Malaysia","Pakistan","Philippines","Singapore","Thailand","Taiwan"],
            "name": "Country: "
        }
      }]
  }
